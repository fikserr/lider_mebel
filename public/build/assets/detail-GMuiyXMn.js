import{j as e,r as s,Y as a,a as l}from"./app-BYElD7EB.js";import{H as t,d as i}from"./index-CU9DNees.js";import{u as r}from"./use-toast-DsNCB_oK.js";import"./iconBase-BvghSGLp.js";const o=({isOpen:s,onClose:a})=>s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 px-5",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md max-h-72 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Mahsulot muvaffaqiyatli yuborildi ✅"}),e.jsx("p",{className:"text-slate-500",children:"Xaridingizdan mamnunmiz"}),e.jsx("p",{className:"text-slate-500",children:"Bizning mahsulotlarimizni tanlaganingiz uchun rahmat"}),e.jsx("button",{onClick:a,className:"mt-4 px-6 py-2 bg-black text-white rounded hover:bg-green-900 transition duration-200",children:"Yopish"})]})}):null,n=({detail:n})=>{const[c,d]=s.useState(!1),[m,x]=s.useState(null==n?void 0:n.photo1),[u,p]=s.useState(null),[h,b]=s.useState(null),[g,j]=s.useState(null),[f,v]=s.useState(1),[N,y]=s.useState(!1),{toast:w}=r(),z=s.useMemo(()=>n.variants.map(e=>({...e,sizes:Array.isArray(e.sizes)?e.sizes:[],colors:Array.isArray(e.colors)?e.colors:[]})),[n.variants]),k=s.useMemo(()=>{const e=z.flatMap(e=>e.sizes);return[...new Set(e)]},[z]),S=s.useMemo(()=>u?[...new Set(z.filter(e=>e.sizes.includes(u)).flatMap(e=>e.colors))]:[...new Set(z.flatMap(e=>e.colors))],[z,u]);s.useEffect(()=>{if(u&&h){const e=z.find(e=>e.sizes.includes(u)&&e.colors.includes(h));j(e||null)}else j(null)},[u,h,z]),s.useEffect(()=>{g&&(!u&&g.sizes.length>0&&p(g.sizes[0]),!h&&g.colors.length>0&&b(g.colors[0]))},[g]);return e.jsxs("div",{className:"my-20 px-5 xl:px-32",children:[e.jsxs(a,{href:"/",className:"inline-flex items-center mb-2 hover:opacity-70",children:[e.jsx(t,{className:"mr-2 text-xl"}),e.jsx("p",{className:"font-bold text-2xl",children:"Orqaga"})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-5 md:gap-10 xl:grid-cols-2",children:[e.jsxs("div",{className:"border-b-blue-300 grid gap-4 border-b-2",children:[m&&e.jsx("img",{src:`/storage/${m}?v=${Date.now()}`,loading:"lazy",alt:n.product_name||"Product image",className:"w-full h-[350px] rounded-2xl object-cover"}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[n.photo1,n.photo2,n.photo3].map((s,a)=>s&&e.jsx("img",{src:`/storage/${s}?v=${Date.now()}`,loading:"lazy",alt:`Product ${a+1}`,className:"w-full h-[130px] object-cover rounded-lg cursor-pointer "+(m===s?"ring-2 ring-blue-400":""),onClick:()=>x(s)},a))})]}),e.jsxs("div",{className:"my-5",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4 font-oswald",children:n.product_name}),e.jsx("h2",{className:"font-semibold mb-2 text-lg",children:"O‘lchamlar:"}),e.jsx("div",{className:"flex gap-2 flex-wrap mb-4",children:k.map((s,a)=>e.jsx("button",{onClick:()=>{p(s),b(null)},className:"border rounded-lg px-4 py-1 cursor-pointer "+(u===s?"bg-black text-white":"bg-gray-100 hover:bg-gray-200"),children:s},a))}),e.jsx("h2",{className:"font-semibold mb-2 text-lg",children:"Ranglar:"}),e.jsx("div",{className:"flex gap-2 flex-wrap mb-4",children:S.map((s,a)=>e.jsx("button",{onClick:()=>b(s),className:"border rounded-full px-4 py-1 cursor-pointer "+(h===s?"bg-black text-white":"bg-gray-100 hover:bg-gray-200"),children:s},a))}),e.jsxs("div",{className:"flex items-center justify-between mt-5",children:[e.jsxs("p",{className:"font-oswald",children:["Narxi:"," ",(null==g?void 0:g.price)??n.price," ",e.jsx("span",{className:"text-sm text-slate-500",children:"so'm"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>v(e=>Math.max(1,e-1)),className:"border px-2",children:"-"}),e.jsx("span",{children:f}),e.jsx("button",{onClick:()=>v(e=>e+1),className:"border px-2",children:"+"})]})]}),e.jsx("button",{onClick:()=>{g&&u&&h?(y(!0),l.post("/add-to-cart",{product_id:n.id,quantity:f,size:u,color:h,price:g.price}).then(()=>{w({title:"Savatga qo‘shildi ✅",description:`${n.product_name} (${u}, ${h}) savatga qo‘shildi!`}),d(!0)}).catch(e=>{var s;console.error(null==(s=e.response)?void 0:s.data),w({title:"Xatolik",description:"Savatga qo‘shishda xatolik yuz berdi.",variant:"destructive"})}).finally(()=>{y(!1)})):w({title:"Xatolik",description:"Iltimos, o‘lcham va rangni tanlang",variant:"destructive"})},disabled:N,className:"mt-4 w-full bg-black text-white py-2 rounded-md disabled:opacity-50",children:N?"Yuklanmoqda...":"Savatga qo‘shish"}),e.jsx("div",{className:"my-5 px-2 pt-2",children:e.jsx("p",{className:"text-black border-b-blue-700 border-b-2 pb-2 cursor-pointer",children:"Tafsilotlar"})}),e.jsx("div",{className:"space-y-2",children:["Kategoriya","Brend","Rangi"].map((s,a)=>{var l;const t=[(null==(l=null==n?void 0:n.category)?void 0:l.name)||"Noma'lum",(null==n?void 0:n.brend)||"Yo‘q",h||"Noma'lum"];return e.jsxs("div",{className:"flex items-center justify-between font-oswald",children:[e.jsx("h3",{style:{fontSize:"20px"},children:s}),e.jsxs("span",{className:"text-slate-600 flex items-center",children:[t[a]," ",e.jsx(i,{})]})]},a)})})]})]}),e.jsx(o,{isOpen:c,onClose:()=>d(!1)})]})};export{n as default};
